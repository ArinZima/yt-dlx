const urls = [
  {
    filename: "233 - audio only (Default)",
    url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1710670268/ei/XG32ZZ-AJLOo4t4P_9CukAQ/ip/2409:40e6:3f:48b9:9302:9b68:7e1d:5a7b/id/01b167b1a0d03184/itag/233/source/youtube/requiressl/yes/ratebypass/yes/pfa/1/goi/133/sgoap/clen%3D1821807%3Bdur%3D298.655%3Bgir%3Dyes%3Bitag%3D139%3Blmt%3D1709439406264355/rqh/1/hls_chunk_host/rr2---sn-gwpa-b50s.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/mh/my/mm/31,29/mn/sn-gwpa-b50s,sn-qxaelnez/ms/au,rdu/mv/m/mvi/2/pl/48/force_finished/1/initcwndbps/498750/vprv/1/playlist_type/DVR/dover/13/txp/5532434/mt/1710647822/fvip/1/short_key/1/keepalive/yes/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,pfa,goi,sgoap,rqh,xpc,force_finished,vprv,playlist_type/sig/AJfQdSswRAIgBltDNA-2xsxeQqH0ghozpHN6-yWXWSH9xq6jXQGCI9MCIFGjSa_SYEV7ZPIfa7kxIXEp7kO3NVcUmkye9ccK3SAi/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl,initcwndbps/lsig/ALClDIEwRQIhAOhJyk64naFvYpOarXIADPzt_J0QH3r5a3g__FrW4E0aAiBYZu5O6exNdykshQt1VvAlPd50VTGRXwWPjzm6ukbIGA%3D%3D/playlist/index.m3u8",
  },
  {
    filename: "234 - audio only (Default)",
    url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1710670268/ei/XG32ZZ-AJLOo4t4P_9CukAQ/ip/2409:40e6:3f:48b9:9302:9b68:7e1d:5a7b/id/01b167b1a0d03184/itag/234/source/youtube/requiressl/yes/ratebypass/yes/pfa/1/goi/133/sgoap/clen%3D4832946%3Bdur%3D298.585%3Bgir%3Dyes%3Bitag%3D140%3Blmt%3D1709439405833807/rqh/1/hls_chunk_host/rr2---sn-gwpa-b50s.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/mh/my/mm/31,29/mn/sn-gwpa-b50s,sn-qxaelnez/ms/au,rdu/mv/m/mvi/2/pl/48/force_finished/1/initcwndbps/498750/vprv/1/playlist_type/DVR/dover/13/txp/5532434/mt/1710647822/fvip/1/short_key/1/keepalive/yes/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,pfa,goi,sgoap,rqh,xpc,force_finished,vprv,playlist_type/sig/AJfQdSswRQIhAKh1kAI3TYsJXJSYzsDn8wIsdY1-ugyYRhOQahMM8ntkAiBctp3-zZ31syqaim0uzEuPmZ8OQBm1AKBtqB7YkoPOsg%3D%3D/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl,initcwndbps/lsig/ALClDIEwRgIhAKAgugCnmPQ-R0XXMxDYjuHpQAJ8ZlLDQ_rVXnW3Q-yIAiEAygKdTEPFu5Uzz13Tq7C2hjbZn2M8p5G9pi33qgfgAlc%3D/playlist/index.m3u8",
  },
  {
    filename: "603 - 256x144",
    url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1710670268/ei/XG32ZZ-AJLOo4t4P_9CukAQ/ip/2409:40e6:3f:48b9:9302:9b68:7e1d:5a7b/id/01b167b1a0d03184/itag/603/source/youtube/requiressl/yes/ratebypass/yes/pfa/1/wft/1/sgovp/clen%3D2411227%3Bdur%3D298.500%3Bgir%3Dyes%3Bitag%3D278%3Blmt%3D1709443872249689/rqh/1/hls_chunk_host/rr2---sn-gwpa-b50s.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/mh/my/mm/31,29/mn/sn-gwpa-b50s,sn-qxaelnez/ms/au,rdu/mv/m/mvi/2/pl/48/force_finished/1/initcwndbps/498750/vprv/1/playlist_type/DVR/dover/13/txp/5537434/mt/1710647822/fvip/1/short_key/1/keepalive/yes/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,pfa,wft,sgovp,rqh,xpc,force_finished,vprv,playlist_type/sig/AJfQdSswRgIhAIHpY8qtK-xkx6Amhu0u3zSOZQUgxIHnI8xo952wavEAAiEA8GwkWELlKjA83agk4RVYP7LjZ6usERDPYw2gAz8Wgqw%3D/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl,initcwndbps/lsig/ALClDIEwRAIgbxmoRyy91Fu6SW0W14omBYqw_Fj-sKCYCujXwgwSBCECIG8IizIvHgrnbZAxRie912N3SOEmYEouQWDvgtxS4wqt/playlist/index.m3u8",
  },
  {
    filename: "604 - 426x240",
    url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1710670268/ei/XG32ZZ-AJLOo4t4P_9CukAQ/ip/2409:40e6:3f:48b9:9302:9b68:7e1d:5a7b/id/01b167b1a0d03184/itag/604/source/youtube/requiressl/yes/ratebypass/yes/pfa/1/wft/1/sgovp/clen%3D3075458%3Bdur%3D298.500%3Bgir%3Dyes%3Bitag%3D242%3Blmt%3D1709443875964500/rqh/1/hls_chunk_host/rr2---sn-gwpa-b50s.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/mh/my/mm/31,29/mn/sn-gwpa-b50s,sn-qxaelnez/ms/au,rdu/mv/m/mvi/2/pl/48/force_finished/1/initcwndbps/498750/vprv/1/playlist_type/DVR/dover/13/txp/5537434/mt/1710647822/fvip/1/short_key/1/keepalive/yes/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,pfa,wft,sgovp,rqh,xpc,force_finished,vprv,playlist_type/sig/AJfQdSswRAIgREKhjYyQVLlRowBrH0dkp8Z0e1AunaYl2or4N4052rQCIGyz13tWzaIIxmFIQ-kREs-JuUbGpD2ufdrif9Tl-Lw5/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl,initcwndbps/lsig/ALClDIEwRQIhAIU1QB5H6mHjSGOL49YJ7RgAcyvzwYed_1wTcBRvX5uhAiANJXB0M_a4wf3QBAyHx8qg-U8lXpKQo9YizoTwosjGVg%3D%3D/playlist/index.m3u8",
  },
  {
    filename: "605 - 640x360",
    url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1710670268/ei/XG32ZZ-AJLOo4t4P_9CukAQ/ip/2409:40e6:3f:48b9:9302:9b68:7e1d:5a7b/id/01b167b1a0d03184/itag/605/source/youtube/requiressl/yes/ratebypass/yes/pfa/1/wft/1/sgovp/clen%3D6853296%3Bdur%3D298.500%3Bgir%3Dyes%3Bitag%3D243%3Blmt%3D1709443905666874/rqh/1/hls_chunk_host/rr2---sn-gwpa-b50s.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/mh/my/mm/31,29/mn/sn-gwpa-b50s,sn-qxaelnez/ms/au,rdu/mv/m/mvi/2/pl/48/force_finished/1/initcwndbps/498750/vprv/1/playlist_type/DVR/dover/13/txp/5537434/mt/1710647822/fvip/1/short_key/1/keepalive/yes/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,pfa,wft,sgovp,rqh,xpc,force_finished,vprv,playlist_type/sig/AJfQdSswRgIhAPLwwoFZ-9AeMqCEM2HwbF1EG8BVn5182Ogycv9Z_K4kAiEArA96wveVBnp-Z3xQhTboedPMrY1Pcu1Mx1tlobuYu5I%3D/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl,initcwndbps/lsig/ALClDIEwRgIhAL-2QnJjKx39I7zSTysX0aK7dycafifsI7lL0NRqiegfAiEAxleY9ObaMS1FOcz9hg59k9MTHV8mnJ7YfevpjSQ4oZY%3D/playlist/index.m3u8",
  },
  {
    filename: "606 - 854x480",
    url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1710670268/ei/XG32ZZ-AJLOo4t4P_9CukAQ/ip/2409:40e6:3f:48b9:9302:9b68:7e1d:5a7b/id/01b167b1a0d03184/itag/606/source/youtube/requiressl/yes/ratebypass/yes/pfa/1/wft/1/sgovp/clen%3D10907152%3Bdur%3D298.500%3Bgir%3Dyes%3Bitag%3D244%3Blmt%3D1709444233879660/rqh/1/hls_chunk_host/rr2---sn-gwpa-b50s.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/mh/my/mm/31,29/mn/sn-gwpa-b50s,sn-qxaelnez/ms/au,rdu/mv/m/mvi/2/pl/48/force_finished/1/initcwndbps/498750/vprv/1/playlist_type/DVR/dover/13/txp/5537434/mt/1710647822/fvip/1/short_key/1/keepalive/yes/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,pfa,wft,sgovp,rqh,xpc,force_finished,vprv,playlist_type/sig/AJfQdSswRAIgdipHuNUNie6Z5CIBWuBJeYJdq-RETgcA0v2kJQ1L9PUCIDoPq8BNqaGhpnpItVpFmlDmVXTuMlSR16dGnd86B_14/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl,initcwndbps/lsig/ALClDIEwRAIgYegxkjHBORSVXhZhXAlSOaKWuqGanZo9AVISewXqeUsCIE9knPGGCXTHKee2gI5h12eQYK_L0VX8vEujPtchRxPv/playlist/index.m3u8",
  },
  {
    filename: "609 - 1280x720",
    url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1710670268/ei/XG32ZZ-AJLOo4t4P_9CukAQ/ip/2409:40e6:3f:48b9:9302:9b68:7e1d:5a7b/id/01b167b1a0d03184/itag/609/source/youtube/requiressl/yes/ratebypass/yes/pfa/1/wft/1/sgovp/clen%3D20071627%3Bdur%3D298.500%3Bgir%3Dyes%3Bitag%3D247%3Blmt%3D1709444367277954/rqh/1/hls_chunk_host/rr2---sn-gwpa-b50s.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/mh/my/mm/31,29/mn/sn-gwpa-b50s,sn-qxaelnez/ms/au,rdu/mv/m/mvi/2/pl/48/force_finished/1/initcwndbps/498750/vprv/1/playlist_type/DVR/dover/13/txp/5537434/mt/1710647822/fvip/1/short_key/1/keepalive/yes/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,pfa,wft,sgovp,rqh,xpc,force_finished,vprv,playlist_type/sig/AJfQdSswRgIhAIIJZZliw68zzDhQz_WMqBeRlhoIDGfhKLoSwXbUFB0fAiEAqpu4fRltUwsvgerrZXzXK7zKjnSK2UrztPspDCLT2k4%3D/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl,initcwndbps/lsig/ALClDIEwRAIgNcKVsFMvQOwgHLL7bWlTI4QLTTNmvUG3ZM3OE2aDCP0CICvs_4R8M3fWwR-1yAVVcliQgsx0gL4VURvNIFGsMQzQ/playlist/index.m3u8",
  },
  {
    filename: "614 - 1920x1080",
    url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1710670268/ei/XG32ZZ-AJLOo4t4P_9CukAQ/ip/2409:40e6:3f:48b9:9302:9b68:7e1d:5a7b/id/01b167b1a0d03184/itag/614/source/youtube/requiressl/yes/ratebypass/yes/pfa/1/wft/1/sgovp/clen%3D34779112%3Bdur%3D298.500%3Bgir%3Dyes%3Bitag%3D248%3Blmt%3D1709443758105242/rqh/1/hls_chunk_host/rr2---sn-gwpa-b50s.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/mh/my/mm/31,29/mn/sn-gwpa-b50s,sn-qxaelnez/ms/au,rdu/mv/m/mvi/2/pl/48/force_finished/1/initcwndbps/498750/vprv/1/playlist_type/DVR/dover/13/txp/5537434/mt/1710647822/fvip/1/short_key/1/keepalive/yes/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,pfa,wft,sgovp,rqh,xpc,force_finished,vprv,playlist_type/sig/AJfQdSswRQIgNdrSknzesujbAGry0L8TR7zZNbqSCO9cWKv5l6V3ov0CIQDdHXw4yQ6cZMNtzg72g7F7xWBJ_WZUBPUPGTPje7Svag%3D%3D/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl,initcwndbps/lsig/ALClDIEwRAIgcemEPMko_Ijyk7u8a0us_2AXd2SZFW5aoXi2MOIP5tECIFu_78Z3TeAtR-tUFrc2Z5kwOCVu5Q5TDd_NBsM2xFmi/playlist/index.m3u8",
  },
  {
    filename: "625 - 3840x2160",
    url: "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1710670268/ei/XG32ZZ-AJLOo4t4P_9CukAQ/ip/2409:40e6:3f:48b9:9302:9b68:7e1d:5a7b/id/01b167b1a0d03184/itag/625/source/youtube/requiressl/yes/ratebypass/yes/pfa/1/wft/1/sgovp/clen%3D361102357%3Bdur%3D298.500%3Bgir%3Dyes%3Bitag%3D313%3Blmt%3D1709442848228962/rqh/1/hls_chunk_host/rr2---sn-gwpa-b50s.googlevideo.com/xpc/EgVo2aDSNQ%3D%3D/mh/my/mm/31,29/mn/sn-gwpa-b50s,sn-qxaelnez/ms/au,rdu/mv/m/mvi/2/pl/48/force_finished/1/initcwndbps/498750/vprv/1/playlist_type/DVR/dover/13/txp/5532434/mt/1710647822/fvip/1/short_key/1/keepalive/yes/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,pfa,wft,sgovp,rqh,xpc,force_finished,vprv,playlist_type/sig/AJfQdSswRgIhAN_hjWr1tRCeQlVOn4Ozij8VZ4816lX1WuvrjM2GjQhlAiEAgDNm5rOGLnCcotmydTWWQhqCW1QlkvvmnLgS8c8MeNM%3D/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl,initcwndbps/lsig/ALClDIEwRQIhANruGfW7HgGEe6RZ2dAXoMQXhib5yy5gKXH1lwfqwgsjAiAowZjRNvGiECyMlst0FYuN_eq-dg5RMRj9DRIZMEf-aw%3D%3D/playlist/index.m3u8",
  },
];

import ffmpeg from "fluent-ffmpeg";

async function downloadAndMerge(urlObj, outputFilePath) {
  return new Promise(async (resolve, reject) => {
    try {
      const { filename, url } = urlObj;
      const ff = ffmpeg(url);
      ff.outputOptions("-c copy");
      ff.output(`${outputFilePath}/${filename}.mp4`);
      ff.on("start", (command) => {
        console.log("@command:", command);
      });
      ff.on("progress", ({ percent }) => {
        if (isNaN(percent)) return;
        process.stdout.write(
          `\r@progress: ${filename} | ${percent.toFixed(2)}%`
        );
      });
      ff.on("end", () => {
        process.stdout.write("\n\n");
        resolve(`${outputFilePath}/${filename}.mp4`);
      });
      ff.on("error", (error) => reject(error));
      ff.run();
    } catch (error) {
      reject(error);
    }
  });
}

(async () => {
  for (const urlObj of urls) {
    try {
      await downloadAndMerge(urlObj, "public");
    } catch (error) {
      console.error("Error processing file:", error);
    }
  }
})();
